<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="ipynb_website:version" content="0.9.7" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" type="text/css" href="../css/jt.css">

<link rel="stylesheet" type="text/css" href="../css/toc2.css">

<link href="../site_libs/jqueryui-1.11.4/jquery-ui.css">
<link rel="stylesheet" href="../site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<link rel="stylesheet" href="../site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<link rel="stylesheet"
      href="../site_libs/highlightjs/null.min.css"
      type="text/css" />

<script src="../site_libs/highlightjs/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>

<script src="../js/doc_toc.js"></script>
<script src="../js/docs.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>
<script>
function filterDataFrame(id) {
    var input = document.getElementById("search_" + id);
    var filter = input.value.toUpperCase();
    var table = document.getElementById("dataframe_" + id);
    var tr = table.getElementsByTagName("tr");
    // Loop through all table rows, and hide those who don't match the search query
    for (var i = 1; i < tr.length; i++) {
        for (var j = 0; j < tr[i].cells.length; ++j) {
            var matched = false;
            if (tr[i].cells[j].innerHTML.toUpperCase().indexOf(filter) != -1) {
                tr[i].style.display = "";
                matched = true
                break;
            }
            if (!matched)
                tr[i].style.display = "none";
        }
    }
}
function sortDataFrame(id, n, dtype) {
    var table = document.getElementById("dataframe_" + id);
    var tb = table.tBodies[0]; // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
    var tr = Array.prototype.slice.call(tb.rows, 0); // put rows into array
    if (dtype === 'numeric') {
        var fn = function(a, b) { 
            return parseFloat(a.cells[n].textContent) <= parseFloat(b.cells[n].textContent) ? -1 : 1;
        }
    } else {
        var fn = function(a, b) {
            var c = a.cells[n].textContent.trim().localeCompare(b.cells[n].textContent.trim()); 
            return c > 0 ? 1 : (c < 0 ? -1 : 0) }
    }
    var isSorted = function(array, fn) {
        if (array.length < 2)
            return 1;
        var direction = fn(array[0], array[1]); 
        for (var i = 1; i < array.length - 1; ++i) {
            var d = fn(array[i], array[i+1]);
            if (d == 0)
                continue;
            else if (direction == 0)
                direction = d;
            else if (direction != d)
                return 0;
            }
        return direction;
    }
    var sorted = isSorted(tr, fn);
    if (sorted == 1 || sorted == -1) {
        // if sorted already, reverse it
        for(var i = tr.length - 1; i >= 0; --i)
            tb.appendChild(tr[i]); // append each row in order
    } else {
        tr = tr.sort(fn);
        for(var i = 0; i < tr.length; ++i)
            tb.appendChild(tr[i]); // append each row in order
    }
}
</script>

<script>
$( document ).ready(function(){
            var cfg={'threshold':3,     // depth of toc (number of levels)
             'number_sections': false,
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }
            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;
            // fire the main function with these parameters
            table_of_contents(cfg, st);
            var file=analysisDict[$("h1:first").attr("id")];
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            var docs=analysisArray;
            var docs_map=analysisArrayMap;
            var pos=analysisArray.indexOf(file);
            for (var a=pos;a>=0;a--){
                  $('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+file+'.html'+'"]').css("color","#126dce");
            for (var a=pos+1;a<docs.length;a++){
                  $(".toc #toc-level0").append('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>');
            }
            // $("#toc-header").hide(); // comment out because it prevents search bar from displaying
    });
</script>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');
  // mark it active
  menuAnchor.parent().addClass('active');
  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>
<div class="container-fluid main-container">
<!-- tabsets -->
<script src="../site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>



<title>Multivariate Bayesian variable selection regression</title>

<style type = "text/css">
body {
  font-family: "Droid Sans";
  padding-top: 66px;
  padding-bottom: 40px;
}
</style>
</head>

<body>
<div tabindex="-1" id="notebook" class="border-box-sizing">
<div class="container" id="notebook-container">

<!-- code folding -->

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Multivariate Bayesian variable selection regression</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
<li>
  <a href="../index.html">Overview</a>
</li>
        
<li>
  <a href="../analysis.html">Analysis</a>
</li>
        
<li>
  <a href="../prototype.html">Prototype</a>
</li>
        
<li>
  <a href="../writeup.html">Writeup</a>
</li>
        
      </ul>
        
<ul class="nav navbar-nav navbar-right">
<li>
   <a href="http://github.com/gaow/mvarbvs"> <span class="fa fa-github"></span> </a>
</li>
</ul>
        
      </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Identify-and-extract-interesting-data-set-for-vignettes">Identify and extract interesting data-set for vignettes<a class="anchor-link" href="#Identify-and-extract-interesting-data-set-for-vignettes">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">revisions</span> <span class="o">-</span><span class="n">s</span> <span class="o">-</span><span class="n">n</span> <span class="mi">10</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">

        <table class="revision_table">
        <tr>
        <th>Revision</th>
        <th>Author</th>
        <th>Date</th>
        <th>Message</th>
        <tr>
        <tr><td><a target="_blank" href="http://github.com/gaow/mvarbvs/blob/8f5b189ce63d1fccb2ddf544d79a93dae026ee56/analysis/20180606_Identify_Interesting_Dataset.ipynb"><span class="revision_id">8f5b189<span></a></td>
<td>Gao Wang</td>
<td>2018-07-10</td>
<td>Update documentation</td></tr><tr><td><a target="_blank" href="http://github.com/gaow/mvarbvs/blob/12fe3639ca1b2e6c50e20ef8a221f4f4de0a8cb9/analysis/20180606_Identify_Interesting_Dataset.ipynb"><span class="revision_id">12fe363<span></a></td>
<td>Gao Wang</td>
<td>2018-06-27</td>
<td>Add finemap 95% config filter</td></tr><tr><td><a target="_blank" href="http://github.com/gaow/mvarbvs/blob/d5574254873e939930b65994572c189e8ff5001b/analysis/20180606_Identify_Interesting_Dataset.ipynb"><span class="revision_id">d557425<span></a></td>
<td>Gao Wang</td>
<td>2018-06-27</td>
<td>Update documentation</td></tr></table>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">cd</span> <span class="o">~/</span><span class="n">GIT</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">mvarbvs</span><span class="o">/</span><span class="n">dsc</span><span class="o">/</span><span class="n">susie_comparison</span><span class="o">/</span><span class="n">fit_susie</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>/home/gaow/GIT/github/mvarbvs/dsc/susie_comparison/fit_susie</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="p">[</span><span class="k">global</span><span class="p">]</span>
<span class="n">cwd</span> <span class="o">=</span> <span class="n">path</span><span class="p">(</span><span class="s1">&#39;~/GIT/github/mvarbvs/dsc&#39;</span><span class="p">)</span>
<span class="n">dirname</span> <span class="o">=</span> <span class="n">path</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{cwd:a}/susie_comparison/&#39;</span><span class="p">)</span>
<span class="kn">parameter:</span> <span class="kp">name</span> <span class="o">=</span> <span class="s1">&#39;20180710&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-non-trivial-show-case-example-for-fine-mapping-vignette">A non-trivial show case example for fine-mapping vignette<a class="anchor-link" href="#A-non-trivial-show-case-example-for-fine-mapping-vignette">&#182;</a></h2><p>Here I'd like to pick up ideally examples that has enough power for susie to detect 3 simulated signals, at non-trivial yet reasonable number of iterations, size of sets and purity levels, for illustrating how susie works. In other words this is meant to pick up good susie show cases, not edge cases.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="p">[</span><span class="n">A</span><span class="p">]</span>
<span class="n">num_causal</span> <span class="o">=</span> <span class="mi">3</span>
<span class="kn">input:</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;liter_data_*_summarize_ld_1_lm_less_{num_causal}_fit_susie_*.rds&#39;</span><span class="p">)[:</span><span class="mi">200</span><span class="p">],</span> <span class="n">group_by</span> <span class="o">=</span> <span class="s1">&#39;single&#39;</span> 
<span class="kn">R:</span> <span class="n">expand</span> <span class="o">=</span> <span class="s1">&#39;${ }&#39;</span>
  <span class="n">res</span> <span class="o">=</span> <span class="n">readRDS</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">_input</span><span class="p">:</span><span class="n">r</span><span class="p">})</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
  	<span class="n">cs</span> <span class="o">=</span> <span class="n">susieR</span><span class="p">::</span><span class="n">susie_get_CS</span><span class="p">(</span><span class="n">res</span><span class="err">$</span><span class="n">posterior</span><span class="err">$</span><span class="n">alpha</span><span class="p">[[</span><span class="n">r</span><span class="p">]])</span><span class="err">$</span><span class="n">cs</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="err">$</span><span class="p">{</span><span class="n">num_causal</span><span class="p">}]</span>
  	<span class="k">if</span> <span class="p">(</span><span class="n">length</span><span class="p">(</span><span class="n">cs</span><span class="p">[[</span><span class="err">$</span><span class="p">{</span><span class="n">num_causal</span><span class="p">}]])</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
  		<span class="k">print</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">_input</span><span class="p">:</span><span class="n">r</span><span class="p">})</span>
		<span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
  		<span class="k">print</span><span class="p">(</span><span class="n">res</span><span class="err">$</span><span class="n">posterior</span><span class="err">$</span><span class="n">niter</span><span class="p">[</span><span class="n">r</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
		<span class="k">print</span><span class="p">(</span><span class="s2">&quot;========&quot;</span><span class="p">)</span>
  	<span class="p">}</span>
  <span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I ended up with <code>liter_data_65_summarize_ld_1_lm_less_3_fit_susie_7.rds</code> the first data-set, which seems interesting:</p>

<pre><code>[[1]]
[1] 773 777

[[2]]
 [1] 360 361 362 365 368 372 373 374 379 381 383 384 386 387 388 389 391 392 396
[20] 397 398 399 400 401 403 404 405 407 408 415

[[3]]
[1] 653</code></pre>
<p>takes 6 iterations to complete.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">dat</span> <span class="o">=</span> <span class="n">readRDS</span><span class="p">(</span><span class="s1">&#39;liter_data_65_summarize_ld_1_lm_less_3_fit_susie_7.rds&#39;</span><span class="p">)</span>
<span class="n">names</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>'posterior'</li>
	<li>'fitted'</li>
	<li>'DSC_DEBUG'</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From <code>dat$DSC_DEBUG$script</code> I load the dataset of interest:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="nb">input</span> <span class="o">&lt;-</span> <span class="n">dscrutils</span><span class="p">::</span><span class="n">load_inputs</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="s1">&#39;../lm_less/liter_data_65_summarize_ld_1_lm_less_3.pkl&#39;</span><span class="p">),</span> <span class="n">dscrutils</span><span class="p">::</span><span class="n">read_dsc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">names</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>'data'</li>
	<li>'V'</li>
	<li>'N'</li>
	<li>'DSC_DEBUG'</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now I compute summary stats and save it.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">library</span><span class="p">(</span><span class="n">abind</span><span class="p">)</span>
<span class="n">mm_regression</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="o">=</span><span class="n">NULL</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="err">!</span><span class="ow">is</span><span class="o">.</span><span class="n">null</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span> <span class="p">{</span>
      <span class="n">Z</span> <span class="o">=</span> <span class="k">as</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
  <span class="p">}</span>
  <span class="n">reg</span> <span class="o">=</span> <span class="n">lapply</span><span class="p">(</span><span class="n">seq_len</span><span class="p">(</span><span class="n">ncol</span><span class="p">(</span><span class="n">Y</span><span class="p">)),</span> <span class="n">function</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="n">simplify2array</span><span class="p">(</span><span class="n">susieR</span><span class="p">:::</span><span class="n">univariate_regression</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">[,</span><span class="n">i</span><span class="p">],</span> <span class="n">Z</span><span class="p">)))</span>
  <span class="n">reg</span> <span class="o">=</span> <span class="n">do</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">abind</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">along</span><span class="o">=</span><span class="mi">0</span><span class="p">)))</span>
  <span class="c1"># return array: out[1,,] is betahat, out[2,,] is shat</span>
  <span class="k">return</span><span class="p">(</span><span class="n">aperm</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="p">}</span>
<span class="n">sumstats</span> <span class="o">=</span> <span class="n">mm_regression</span><span class="p">(</span><span class="k">as</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="nb">input</span><span class="err">$</span><span class="n">data</span><span class="err">$</span><span class="n">X</span><span class="p">),</span> <span class="k">as</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="nb">input</span><span class="err">$</span><span class="n">data</span><span class="err">$</span><span class="n">Y</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since the data is private I may have to remove column and row names from data matrices:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">names</span><span class="p">(</span><span class="nb">input</span><span class="err">$</span><span class="n">data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<ol class=list-inline>
	<li>'X'</li>
	<li>'chrom'</li>
	<li>'pos'</li>
	<li>'true_coef'</li>
	<li>'residual_variance'</li>
	<li>'Y'</li>
	<li>'allele_freq'</li>
	<li>'V'</li>
</ol>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Okay after checking the data details there is nothing confidential to hide. We should be good.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">saveRDS</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="nb">input</span><span class="err">$</span><span class="n">data</span><span class="p">,</span> <span class="n">sumstats</span> <span class="o">=</span> <span class="n">sumstats</span><span class="p">),</span> <span class="s1">&#39;~/GIT/software/susieR/inst/data/N3finemapping.rds&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-reasonably-&quot;difficult&quot;-case">A reasonably "difficult" case<a class="anchor-link" href="#A-reasonably-&quot;difficult&quot;-case">&#182;</a></h2><p>We hope to see and show that SuSiE can deal with this reasonably difficult case where in the 2 CS setting the top z-score is result of contribution from both CS -- that is, a SNP is in weak LD between both of 2 CS, thus showing strongest z-score in univariate analysis but weak PIP and not in any CS. Need information on:</p>
<ul>
<li>top z-score (summary stats)</li>
<li>true effect 0 or 1</li>
<li>CS and PIP</li>
<li>CS best is 2; true effect in CS but z-score not in CS</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="p">[</span><span class="n">B_1</span><span class="p">]</span>
<span class="n">target_susie</span> <span class="o">=</span> <span class="s2">&quot;liter_data.dataset lm_less.pve lm_less.n_signal fit_susie.estimate_residual_variance fit_susie.prior_var fit_susie&quot;</span>
<span class="n">target_sumstats</span> <span class="o">=</span> <span class="s2">&quot;liter_data.dataset lm_less.pve lm_less.n_signal get_sumstats lm_less&quot;</span>
<span class="kn">output:</span> <span class="n">f</span><span class="s1">&#39;{dirname}/tutorial_{name}/result.RDS&#39;</span>
<span class="kn">R:</span> <span class="n">expand</span> <span class="o">=</span> <span class="s1">&#39;${ }&#39;</span>
    <span class="n">susie_out</span> <span class="o">=</span> <span class="n">dscrutils</span><span class="p">::</span><span class="n">dscquery</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">dirname</span><span class="p">:</span><span class="n">r</span><span class="p">},</span> <span class="n">target</span> <span class="o">=</span> <span class="s2">&quot;${target_susie}&quot;</span><span class="p">,</span> <span class="n">load</span><span class="o">.</span><span class="n">pkl</span> <span class="o">=</span> <span class="n">TRUE</span><span class="p">)</span>
    <span class="n">sumstats_out</span> <span class="o">=</span> <span class="n">dscrutils</span><span class="p">::</span><span class="n">dscquery</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">dirname</span><span class="p">:</span><span class="n">r</span><span class="p">},</span> <span class="n">target</span> <span class="o">=</span> <span class="s2">&quot;${target_sumstats}&quot;</span><span class="p">,</span> <span class="n">load</span><span class="o">.</span><span class="n">pkl</span> <span class="o">=</span> <span class="n">FALSE</span><span class="p">)</span>
    <span class="n">saveRDS</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">susie_out</span><span class="o">=</span><span class="n">susie_out</span><span class="p">,</span> <span class="n">sumstats_out</span><span class="o">=</span><span class="n">sumstats_out</span><span class="p">),</span> <span class="err">$</span><span class="p">{</span><span class="n">_output</span><span class="p">:</span><span class="n">r</span><span class="p">})</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Workflow can only be executed with magic %run or %sosrun.</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="p">[</span><span class="n">B_2</span><span class="p">]</span>
<span class="n">pve</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">]</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">est_res</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;TRUE&#39;</span><span class="p">]</span>
<span class="n">prior</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">]</span> <span class="c1"># 0.2 / (1-0.2)</span>
<span class="n">combos</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pve</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">est_res</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">prior</span><span class="p">)</span>
<span class="kn">input:</span> <span class="n">for_each</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pve&#39;</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;est_res&#39;</span><span class="p">,</span> <span class="s1">&#39;prior&#39;</span><span class="p">],</span> <span class="kp">concurrent</span> <span class="o">=</span> <span class="bp">True</span>
<span class="kn">output:</span> <span class="n">dynamic</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{_input:d}/*.rds&#39;</span><span class="p">))</span>
<span class="kn">R:</span> <span class="n">expand</span> <span class="o">=</span> <span class="s1">&#39;${ }&#39;</span>
    <span class="n">options</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">999</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">readRDS</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">_input</span><span class="p">:</span><span class="n">r</span><span class="p">})</span>
    <span class="n">susie_out</span> <span class="o">=</span> <span class="n">out</span><span class="err">$</span><span class="n">susie_out</span>
    <span class="n">sumstats_out</span> <span class="o">=</span> <span class="n">out</span><span class="err">$</span><span class="n">sumstats_out</span>
    <span class="c1"># favorit susie flavor</span>
    <span class="n">susie_out</span> <span class="o">=</span> <span class="n">susie_out</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="n">susie_out</span><span class="err">$</span><span class="n">fit_susie</span><span class="o">.</span><span class="n">prior_var</span> <span class="o">==</span> <span class="err">$</span><span class="p">{</span><span class="n">_prior</span><span class="p">}</span> <span class="o">&amp;</span> <span class="n">susie_out</span><span class="err">$</span><span class="n">fit_susie</span><span class="o">.</span><span class="n">estimate_residual_variance</span> <span class="o">==</span> <span class="err">$</span><span class="p">{</span><span class="n">_est_res</span><span class="p">}</span> <span class="o">&amp;</span> <span class="n">susie_out</span><span class="err">$</span><span class="n">lm_less</span><span class="o">.</span><span class="n">n_signal</span> <span class="o">==</span> <span class="err">$</span><span class="p">{</span><span class="n">_n</span><span class="p">}</span> <span class="o">&amp;</span> <span class="n">susie_out</span><span class="err">$</span><span class="n">lm_less</span><span class="o">.</span><span class="n">pve</span> <span class="o">==</span> <span class="err">$</span><span class="p">{</span><span class="n">_pve</span><span class="p">}),</span> <span class="p">]</span>
    <span class="n">sumstats_out</span> <span class="o">=</span> <span class="n">sumstats_out</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="n">sumstats_out</span><span class="err">$</span><span class="n">lm_less</span><span class="o">.</span><span class="n">n_signal</span> <span class="o">==</span> <span class="err">$</span><span class="p">{</span><span class="n">_n</span><span class="p">}</span> <span class="o">&amp;</span> <span class="n">sumstats_out</span><span class="err">$</span><span class="n">lm_less</span><span class="o">.</span><span class="n">pve</span> <span class="o">==</span> <span class="err">$</span><span class="p">{</span><span class="n">_pve</span><span class="p">}),</span> <span class="p">]</span>
    <span class="n">data_sets</span> <span class="o">=</span> <span class="n">unique</span><span class="p">(</span><span class="n">susie_out</span><span class="err">$</span><span class="n">liter_data</span><span class="o">.</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">d</span> <span class="ow">in</span> <span class="n">data_sets</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">susie_files</span> <span class="o">=</span> <span class="n">susie_out</span><span class="p">[</span><span class="n">susie_out</span><span class="err">$</span><span class="n">liter_data</span><span class="o">.</span><span class="n">dataset</span> <span class="o">==</span> <span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;fit_susie.output.file&quot;</span><span class="p">),</span> <span class="n">drop</span><span class="o">=</span><span class="n">F</span><span class="p">]</span>
        <span class="n">fit</span> <span class="o">=</span> <span class="n">readRDS</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">dirname</span><span class="p">:</span><span class="n">r</span><span class="p">},</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">susie_files</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.rds&#39;</span><span class="p">))</span><span class="err">$</span><span class="n">posterior</span>
        <span class="n">sumstats_files</span> <span class="o">=</span> <span class="n">sumstats_out</span><span class="p">[</span><span class="n">sumstats_out</span><span class="err">$</span><span class="n">liter_data</span><span class="o">.</span><span class="n">dataset</span> <span class="o">==</span> <span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="s2">&quot;get_sumstats.output.file&quot;</span><span class="p">,</span> <span class="s2">&quot;lm_less.output.file&quot;</span><span class="p">)]</span>
        <span class="n">z_score</span> <span class="o">=</span> <span class="n">readRDS</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">dirname</span><span class="p">:</span><span class="n">r</span><span class="p">},</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">sumstats_files</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;.rds&#39;</span><span class="p">))</span><span class="err">$</span><span class="n">sumstats</span>
        <span class="n">z_score</span> <span class="o">=</span> <span class="n">z_score</span><span class="p">[</span><span class="mi">1</span><span class="p">,,]</span><span class="o">/</span><span class="n">z_score</span><span class="p">[</span><span class="mi">2</span><span class="p">,,]</span>
        <span class="n">dat</span> <span class="o">=</span> <span class="n">readRDS</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">dirname</span><span class="p">:</span><span class="n">r</span><span class="p">},</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">sumstats_files</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;.rds&#39;</span><span class="p">))</span><span class="err">$</span><span class="n">data</span>
        <span class="n">truth</span> <span class="o">=</span> <span class="n">dat</span><span class="err">$</span><span class="n">true_coef</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">dat</span><span class="err">$</span><span class="n">X</span>
  
        <span class="k">for</span> <span class="p">(</span><span class="n">r</span> <span class="ow">in</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">z</span> <span class="o">=</span> <span class="n">z_score</span><span class="p">[,</span><span class="n">r</span><span class="p">]</span>
            <span class="n">signals</span> <span class="o">=</span> <span class="n">which</span><span class="p">(</span><span class="n">truth</span><span class="p">[,</span><span class="n">r</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">sets</span> <span class="o">=</span> <span class="n">susieR</span><span class="p">::</span><span class="n">susie_get_CS</span><span class="p">(</span><span class="n">fit</span><span class="err">$</span><span class="n">alpha</span><span class="p">[[</span><span class="n">r</span><span class="p">]],</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">)</span>
            <span class="n">pip</span> <span class="o">=</span> <span class="n">susieR</span><span class="p">::</span><span class="n">susie_get_PIP</span><span class="p">(</span><span class="n">fit</span><span class="err">$</span><span class="n">alpha</span><span class="p">[[</span><span class="n">r</span><span class="p">]],</span> <span class="n">sets</span><span class="err">$</span><span class="n">cs_index</span><span class="p">)</span>
            <span class="n">cs</span> <span class="o">=</span> <span class="n">lapply</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">sets</span><span class="err">$</span><span class="n">cs</span><span class="p">),</span> <span class="n">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="nb">min</span><span class="p">(</span><span class="n">sets</span><span class="err">$</span><span class="n">cs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]):</span><span class="nb">max</span><span class="p">(</span><span class="n">sets</span><span class="err">$</span><span class="n">cs</span><span class="p">[[</span><span class="n">i</span><span class="p">]]))</span>
            <span class="n">top_z</span> <span class="o">=</span> <span class="n">which</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
            <span class="k">if</span> <span class="p">(</span><span class="err">!</span> <span class="p">(</span><span class="n">top_z</span> <span class="o">%</span><span class="ow">in</span><span class="o">%</span> <span class="n">unlist</span><span class="p">(</span><span class="n">cs</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="nb">any</span><span class="p">(</span><span class="n">signals</span> <span class="o">%</span><span class="ow">in</span><span class="o">%</span> <span class="n">unlist</span><span class="p">(</span><span class="n">sets</span><span class="err">$</span><span class="n">cs</span><span class="p">))</span> <span class="o">&amp;&amp;</span> <span class="n">pip</span><span class="p">[</span><span class="n">top_z</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.1</span> <span class="o">&amp;&amp;</span> <span class="n">length</span><span class="p">(</span><span class="n">sets</span><span class="err">$</span><span class="n">cs</span><span class="p">)</span> <span class="o">==</span> <span class="err">$</span><span class="p">{</span><span class="n">_n</span><span class="p">})</span> <span class="p">{</span>
              <span class="n">counter</span> <span class="o">=</span> <span class="n">counter</span> <span class="o">+</span> <span class="mi">1</span>
              <span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="s1">&#39;=====&#39;</span><span class="p">,</span> <span class="n">counter</span><span class="p">,</span> <span class="s1">&#39;=======&#39;</span><span class="p">))</span>
              <span class="k">print</span><span class="p">(</span><span class="n">top_z</span><span class="p">)</span>
              <span class="k">print</span><span class="p">(</span><span class="n">sets</span><span class="p">)</span>
              <span class="k">print</span><span class="p">(</span><span class="n">signals</span><span class="p">)</span>
              <span class="k">print</span><span class="p">(</span><span class="n">fit</span><span class="err">$</span><span class="n">niter</span><span class="p">[[</span><span class="n">r</span><span class="p">]])</span>
              <span class="k">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
              <span class="n">saveRDS</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">paste0</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">_input</span><span class="p">:</span><span class="n">dr</span><span class="p">},</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">counter</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="s1">&#39;.rds&#39;</span><span class="p">))</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">gaow</span><span class="o">/</span><span class="n">GIT</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">mvarbvs</span><span class="o">/</span><span class="n">dsc</span><span class="o">/</span><span class="n">susie_comparison</span><span class="o">/</span><span class="n">tutorial_20180710</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>/home/gaow/GIT/github/mvarbvs/dsc/susie_comparison/tutorial_20180710</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="err">!</span><span class="n">ls</span> <span class="o">*.</span><span class="n">rds</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>1_2.rds  2_1.rds  3_2.rds
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>I think this case below looks good. I'll make a separate notebook for it to demonstrate.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">dat</span> <span class="o">=</span> <span class="n">readRDS</span><span class="p">(</span><span class="s1">&#39;2_1.rds&#39;</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1">#names(dat)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">pve</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1"># we know from simulation parameters though not saved to this data object ...</span>
<span class="n">library</span><span class="p">(</span><span class="n">susieR</span><span class="p">)</span>
<span class="nb">set</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">dat</span><span class="err">$</span><span class="n">true_coef</span><span class="p">[,</span><span class="n">r</span><span class="p">]</span>
<span class="n">b</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="n">b</span><span class="o">!=</span><span class="mi">0</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">z_score</span> <span class="o">=</span> <span class="n">susieR</span><span class="p">:::</span><span class="n">calc_z</span><span class="p">(</span><span class="n">dat</span><span class="err">$</span><span class="n">X</span><span class="p">,</span> <span class="n">dat</span><span class="err">$</span><span class="n">Y</span><span class="p">[,</span><span class="n">r</span><span class="p">])</span>
<span class="n">susie_pplot</span><span class="p">(</span><span class="n">z_score</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
<span class="n">fitted</span> <span class="o">=</span> <span class="n">susie</span><span class="p">(</span><span class="n">dat</span><span class="err">$</span><span class="n">X</span><span class="p">,</span> <span class="n">dat</span><span class="err">$</span><span class="n">Y</span><span class="p">[,</span><span class="n">r</span><span class="p">],</span> <span class="n">L</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
               <span class="n">estimate_residual_variance</span><span class="o">=</span><span class="n">TRUE</span><span class="p">,</span> 
               <span class="n">prior_variance</span><span class="o">=</span><span class="n">pve</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pve</span><span class="p">),</span>
               <span class="n">tol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">track_fit</span><span class="o">=</span><span class="n">TRUE</span><span class="p">)</span>
<span class="n">sets</span> <span class="o">=</span> <span class="n">susie_get_CS</span><span class="p">(</span><span class="n">fitted</span><span class="p">,</span>
            <span class="n">coverage</span> <span class="o">=</span> <span class="mf">0.95</span><span class="p">,</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">dat</span><span class="err">$</span><span class="n">X</span><span class="p">,</span> 
            <span class="n">min_abs_corr</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="n">pip</span> <span class="o">=</span> <span class="n">susie_get_PIP</span><span class="p">(</span><span class="n">fitted</span><span class="p">,</span> <span class="n">sets</span><span class="err">$</span><span class="n">cs_index</span><span class="p">)</span>
<span class="n">susie_pplot</span><span class="p">(</span><span class="n">pip</span><span class="p">,</span> <span class="n">fitted</span> <span class="o">=</span> <span class="n">fitted</span><span class="p">,</span> <span class="n">CS</span> <span class="o">=</span> <span class="n">sets</span><span class="p">,</span> <span class="n">max_cs</span> <span class="o">=</span> <span class="mf">0.4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;PIP&#39;</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<hr>
Copyright &copy 2016-2020 Gao Wang et al at Stephens Lab, University of Chicago

</div>
</div>
</body>
</html>
