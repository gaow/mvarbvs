<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="ipynb_website:version" content="0.9.7" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<link rel="stylesheet" type="text/css" href="../css/jt.css">

<link rel="stylesheet" type="text/css" href="../css/toc2.css">

<link href="../site_libs/jqueryui-1.11.4/jquery-ui.css">
<link rel="stylesheet" href="../site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<link rel="stylesheet" href="../site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="../site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<link rel="stylesheet"
      href="../site_libs/highlightjs/null.min.css"
      type="text/css" />

<script src="../site_libs/highlightjs/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>

<script src="../js/doc_toc.js"></script>
<script src="../js/docs.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script>
    MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true
        },
        "HTML-CSS": {
            preferredFont: "TeX",
            availableFonts: ["TeX"],
            styles: {
                scale: 110,
                ".MathJax_Display": {
                    "font-size": "110%",
                }
            }
        }
    });
</script>
<script>
function filterDataFrame(id) {
    var input = document.getElementById("search_" + id);
    var filter = input.value.toUpperCase();
    var table = document.getElementById("dataframe_" + id);
    var tr = table.getElementsByTagName("tr");
    // Loop through all table rows, and hide those who don't match the search query
    for (var i = 1; i < tr.length; i++) {
        for (var j = 0; j < tr[i].cells.length; ++j) {
            var matched = false;
            if (tr[i].cells[j].innerHTML.toUpperCase().indexOf(filter) != -1) {
                tr[i].style.display = "";
                matched = true
                break;
            }
            if (!matched)
                tr[i].style.display = "none";
        }
    }
}
function sortDataFrame(id, n, dtype) {
    var table = document.getElementById("dataframe_" + id);
    var tb = table.tBodies[0]; // use `<tbody>` to ignore `<thead>` and `<tfoot>` rows
    var tr = Array.prototype.slice.call(tb.rows, 0); // put rows into array
    if (dtype === 'numeric') {
        var fn = function(a, b) { 
            return parseFloat(a.cells[n].textContent) <= parseFloat(b.cells[n].textContent) ? -1 : 1;
        }
    } else {
        var fn = function(a, b) {
            var c = a.cells[n].textContent.trim().localeCompare(b.cells[n].textContent.trim()); 
            return c > 0 ? 1 : (c < 0 ? -1 : 0) }
    }
    var isSorted = function(array, fn) {
        if (array.length < 2)
            return 1;
        var direction = fn(array[0], array[1]); 
        for (var i = 1; i < array.length - 1; ++i) {
            var d = fn(array[i], array[i+1]);
            if (d == 0)
                continue;
            else if (direction == 0)
                direction = d;
            else if (direction != d)
                return 0;
            }
        return direction;
    }
    var sorted = isSorted(tr, fn);
    if (sorted == 1 || sorted == -1) {
        // if sorted already, reverse it
        for(var i = tr.length - 1; i >= 0; --i)
            tb.appendChild(tr[i]); // append each row in order
    } else {
        tr = tr.sort(fn);
        for(var i = 0; i < tr.length; ++i)
            tb.appendChild(tr[i]); // append each row in order
    }
}
</script>

<script>
$( document ).ready(function(){
            var cfg={'threshold':3,     // depth of toc (number of levels)
             'number_sections': false,
             'toc_cell': false,          // useless here
             'toc_window_display': true, // display the toc window
             "toc_section_display": "block", // display toc contents in the window
             'sideBar':true,       // sidebar or floating window
             'navigate_menu':false       // navigation menu (only in liveNotebook -- do not change)
            }
            var st={};                  // some variables used in the script
            st.rendering_toc_cell = false;
            st.config_loaded = false;
            st.extension_initialized=false;
            st.nbcontainer_marginleft = $('#notebook-container').css('margin-left')
            st.nbcontainer_marginright = $('#notebook-container').css('margin-right')
            st.nbcontainer_width = $('#notebook-container').css('width')
            st.oldTocHeight = undefined
            st.cell_toc = undefined;
            st.toc_index=0;
            // fire the main function with these parameters
            table_of_contents(cfg, st);
            var file=analysisDict[$("h1:first").attr("id")];
            $("#toc-level0 a").css("color","#126dce");
            $('a[href="#'+$("h1:first").attr("id")+'"]').hide()
            var docs=analysisArray;
            var docs_map=analysisArrayMap;
            var pos=analysisArray.indexOf(file);
            for (var a=pos;a>=0;a--){
                  $('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>').insertBefore("#toc-level0 li:eq(0)");
            }
            $('a[href="'+file+'.html'+'"]').css("color","#126dce");
            for (var a=pos+1;a<docs.length;a++){
                  $(".toc #toc-level0").append('<li><a href="'+docs[a]+'.html"><font color="#073642"><b>'+docs_map[docs[a]].replace(/_/g," ")+'</b></font></a></li>');
            }
            // $("#toc-header").hide(); // comment out because it prevents search bar from displaying
    });
</script>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');
  // mark it active
  menuAnchor.parent().addClass('active');
  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>
<div class="container-fluid main-container">
<!-- tabsets -->
<script src="../site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>



<title>Multivariate Bayesian variable selection regression</title>

<style type = "text/css">
body {
  font-family: "Droid Sans";
  padding-top: 66px;
  padding-bottom: 40px;
}
</style>
</head>

<body>
<div tabindex="-1" id="notebook" class="border-box-sizing">
<div class="container" id="notebook-container">

<!-- code folding -->

<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">Multivariate Bayesian variable selection regression</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
<li>
  <a href="../index.html">Overview</a>
</li>
        
<li>
  <a href="../analysis.html">Analysis</a>
</li>
        
<li>
  <a href="../prototype.html">Prototype</a>
</li>
        
<li>
  <a href="../writeup.html">Writeup</a>
</li>
        
      </ul>
        
<ul class="nav navbar-nav navbar-right">
<li>
   <a href="http://github.com/gaow/mvarbvs"> <span class="fa fa-github"></span> </a>
</li>
</ul>
        
      </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Compute-pairwise-LD-for-selected-SNPs">Compute pairwise LD for selected SNPs<a class="anchor-link" href="#Compute-pairwise-LD-for-selected-SNPs">&#182;</a></h1><p>Though it is straightfoward enough to do it in R / Python, I use PLINK to compute the LD matrix.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>PLINK is highly efficient. First I extract the subset of variants of interest from all data, then for a quick look I use <code>--indep-pairwise</code> to prune SNPs at given LD level. Finally I use <code>--r2</code> option to compute LD stats and formally report a summary.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="p">[</span><span class="k">global</span><span class="p">]</span>
<span class="n">cwd</span> <span class="o">=</span> <span class="s1">&#39;~/Documents/GTEx&#39;</span>
<span class="n">mash_snps</span> <span class="o">=</span> <span class="s1">&#39;~/GIT/github/gtexresults_mash/Data/maxz.txt&#39;</span>
<span class="n">mash_snps_all</span> <span class="o">=</span> <span class="s2">&quot;${cwd!a}/mash_revision/MatrixEQTLSumStats.Portable.h5&quot;</span>
<span class="n">snp_list</span> <span class="o">=</span> <span class="s2">&quot;${cwd!a}/mash_revision/snp_eqtls.txt&quot;</span>
<span class="n">snp_list_random</span> <span class="o">=</span> <span class="s2">&quot;${cwd!a}/mash_revision/snp_random.txt&quot;</span>
<span class="n">genotype_data</span> <span class="o">=</span> <span class="s2">&quot;${cwd!a}/genotype_plink/GTEx7.Imputed.bed&quot;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Prepare-SNP-ID-list-to-extract">Prepare SNP ID list to extract<a class="anchor-link" href="#Prepare-SNP-ID-list-to-extract">&#182;</a></h2><p>For example, codes below prepares SNPs using the eQTLs from <code>mash</code> paper.</p>
<h3 id="From-text-file">From text file<a class="anchor-link" href="#From-text-file">&#182;</a></h3><p>In particular <a href="https://github.com/stephenslab/gtexresults_mash/blob/master/Data/maxz.txt">this file</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">preview</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">gaow</span><span class="o">/</span><span class="n">GIT</span><span class="o">/</span><span class="n">github</span><span class="o">/</span><span class="n">gtexresults_mash</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">maxz</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">limit</span> <span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div class="sos_hint">> /home/gaow/GIT/github/gtexresults_mash/Data/maxz.txt (12.7 MiB):</div>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&#34;Adipose_Subcutaneous&#34; &#34;Adipose_Visceral_Omentum&#34; &#34;Adrenal_Gland&#34; &#34;Artery_Aorta&#34; &#34;Artery_Coronary&#34; &#34;Artery_Tibial&#34; &#34;Brain_Anterior_cingulate_cortex_BA24&#34; &#34;Brain_Caudate_basal_ganglia&#34; &#34;Brain_Cerebellar_Hemisphere&#34; &#34;Brain_Cerebellum&#34; &#34;Brain_Cortex&#34; &#34;Brain_Frontal_Cortex_BA9&#34; &#34;Brain_Hippocampus&#34; &#34;Brain_Hypothalamus&#34; &#34;Brain_Nucleus_accumbens_basal_ganglia&#34; &#34;Brain_Putamen_basal_ganglia&#34; &#34;Breast_Mammary_Tissue&#34; &#34;Cells_EBV-transformed_lymphocytes&#34; &#34;Cells_Transformed_fibroblasts&#34; &#34;Colon_Sigmoid&#34; &#34;Colon_Transverse&#34; &#34;Esophagus_Gastroesophageal_Junction&#34; &#34;Esophagus_Mucosa&#34; &#34;Esophagus_Muscularis&#34; &#34;Heart_Atrial_Appendage&#34; &#34;Heart_Left_Ventricle&#34; &#34;Liver&#34; &#34;Lung&#34; &#34;Muscle_Skeletal&#34; &#34;Nerve_Tibial&#34; &#34;Ovary&#34; &#34;Pancreas&#34; &#34;Pituitary&#34; &#34;Prostate&#34; &#34;Skin_Not_Sun_Exposed_Suprapubic&#34; &#34;Skin_Sun_Exposed_Lower_leg&#34; &#34;Small_Intestine_Terminal_Ileum&#34; &#34;Spleen&#34; &#34;Stomach&#34; &#34;Testis&#34; &#34;Thyroid&#34; &#34;Uterus&#34; &#34;Vagina&#34; &#34;Whole_Blood&#34;
&#34;ENSG00000000419.8_20_49461813_G_C_b37&#34; 0.140035769899035 0.0475048018545887 -0.185199569115366 -0.707475748922068 1.02660000912618 -0.0771338912837303 0.146658841279342 -0.259401046879882 -0.337210009547116 0.39750489467677 -1.05580658870737 0.913743710447618 -0.128762251875501 0.0558638858658976 1.01386831943158 0.377598395957177 -0.479508220110367 0.388489721109613 -0.48229879064876 -0.364704657885265 -1.87231328500187 -2.06022009981082 -0.298559593121012 -3.19471555767819 0.362237923742557 0.62719316987283 2.00021812889745 0.629467212595717 -0.23561462140269 -0.332783730867599 -1.00055889996764 -0.960125863288923 -0.96386316399376 -1.50881700277794 -0.976703698613329 0.577720300522746 -2.60306648809215 -4.85288408765059 0.362665598516544 -1.65680479255712 -0.344732538236625 -0.268148514893524 -0.366403004075725 -0.900413650345225
&#34;ENSG00000000457.9_1_169695110_T_A_b37&#34; 0.954516011454517 -0.0681166567008093 0.109699644838174 2.86331872495593 0.804939975404017 1.66768958423126 1.64030493197248 1.33440714691758 1.7328767895192 5.31231399034445 2.18652298262293 2.79319687293344 0.245677971654259 0.432459156419959 0.720654077312806 1.16943846086518 1.71398578810753 -0.876469953614605 -0.145387404414833 4.50500960459263 1.64784013770758 1.99891911608046 -1.03246629335908 2.93744925688004 0.732560299095379 1.18471867566798 -0.947922268527059 1.33685666941406 1.39094097748753 2.37188680055047 3.07760951738704 -0.277142986781852 1.55727472300494 1.15513554742342 -0.533098042780075 2.58868900891793 1.26249236100172 1.64771825873614 2.12867732922824 -0.0755260844598542 2.11300849607303 3.3059042901439 0.0979415385612671 1.05121147377042
&#34;ENSG00000000460.12_1_169655079_G_A_b37&#34; 0.319836864977651 -0.28858559927055 -0.293302417448151 -0.382708750244296 -1.88572937411031 -0.731279532668538 -2.28866218174984 -3.15452327558819 -5.62131620925679 -6.28282827031234 -3.99155600986804 -1.02718390039357 -1.47529757341139 -1.04324409042758 -1.12330319823082 -1.77672428663425 0.0924974003354592 0.521176495698238 0.439544399604355 -1.29444083282421 -0.285879455613173 -0.810438102891698 -1.2185792561654 -1.05394253140009 -3.29222412895229 -2.47189298266347 3.12046607511662 -2.9484270988292 -2.41368323230473 -3.02474209862182 -1.32488348689969 -0.144362657854571 -2.53363783918856 -2.06456099567809 -0.0106500419867326 0.394751496292719 -0.183182088998179 0.267137151309772 -0.140226463470851 -1.38261451093832 -4.57185776099714 -3.26786047004333 -1.78685206860429 -2.00467145209083
&#34;ENSG00000000938.8_1_27888990_T_C_b37&#34; 1.84387146947355 1.26017531836356 0.277379075325108 2.31477887178685 -0.0762272593808945 1.81648404994728 1.60902560496413 1.39805785681695 0.714104043472631 0.483387491488957 0.691331931801022 1.94391865458563 1.88911503403548 0.12587020716696 -0.136190700141412 1.02030170309299 1.18785319893026 -0.797752689697484 0.131302193902833 -0.211502169456531 1.67371464571622 1.52537581450487 1.57392594799612 2.5610798915074 0.610113571499602 0.988896273913113 -0.148514063655499 3.33285120204704 1.11503124376176 0.58105653912896 1.39801915019313 -0.307152421902023 -1.257704217961 1.71768552657065 1.90436415367498 0.419554183298909 0.487052615599714 -4.4523573610964 0.678535731823725 1.09278301526146 1.31522001167607 0.560447857269273 0.177705680259496 -0.495288113604864
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">sosrun</span> <span class="n">get_list</span>
<span class="p">[</span><span class="n">get_list</span><span class="p">]</span>
<span class="kn">output:</span> <span class="s2">&quot;${snp_list!a}&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s2">&quot;${snp_list!a}&quot;</span><span class="p">,</span> 
           <span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s2">&quot;${mash_snps!a}&quot;</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;str&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span><span class="o">.</span><span class="n">tolist</span><span class="p">()],</span>
          <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div class="sos_hint">%preview /home/gaow/Documents/GTEx/mash_revision/snp_eqtls.txt</div>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div class="sos_hint"> input: <br>output: <a target="_blank" href="/home/gaow/Documents/GTEx/mash_revision/snp_eqtls.txt">/home/gaow/Documents/GTEx/mash_revision/snp_eqtls.txt</a>
</div>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div class="sos_hint">> /home/gaow/Documents/GTEx/mash_revision/snp_eqtls.txt (183.2 KiB):</div>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>20:49461813
1:169695110
1:169655079
1:27888990
1:196513323
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="From-HDF5-table-row-names">From HDF5 table row names<a class="anchor-link" href="#From-HDF5-table-row-names">&#182;</a></h3><p>In particular my GTEx V6 sumstat database <code>MatrixEQTLSumStats.Portable.h5</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">sosrun</span> <span class="n">get_all_list</span>
<span class="p">[</span><span class="n">get_all_list</span><span class="p">]</span>
<span class="kn">output:</span> <span class="n">snp_list</span><span class="p">,</span> <span class="n">snp_list_random</span>
<span class="kn">python:</span>
    <span class="kn">import</span> <span class="nn">h5py</span><span class="o">,</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">mash_snps_all</span><span class="err">!</span><span class="n">ar</span><span class="p">})</span>
    <span class="n">max_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">][</span><span class="s1">&#39;rownames&#39;</span><span class="p">]]</span>
    <span class="n">random_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;:&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;null&#39;</span><span class="p">][</span><span class="s1">&#39;rownames&#39;</span><span class="p">]]</span>
    <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">snp_list</span><span class="err">!</span><span class="n">ar</span><span class="p">},</span> <span class="n">max_list</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="err">$</span><span class="p">{</span><span class="n">snp_list_random</span><span class="err">!</span><span class="n">ar</span><span class="p">},</span> <span class="n">random_list</span><span class="p">,</span> <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div class="sos_hint">%preview /home/gaow/Documents/GTEx/mash_revision/snp_eqtls.txt /home/gaow/Documents/GTEx/mash_revision/snp_random.txt</div>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div class="sos_hint"> input: <br>output: <a target="_blank" href="/home/gaow/Documents/GTEx/mash_revision/snp_eqtls.txt">/home/gaow/Documents/GTEx/mash_revision/snp_eqtls.txt</a>, <a target="_blank" href="/home/gaow/Documents/GTEx/mash_revision/snp_random.txt">/home/gaow/Documents/GTEx/mash_revision/snp_random.txt</a>
</div>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div class="sos_hint">> /home/gaow/Documents/GTEx/mash_revision/snp_eqtls.txt (183.2 KiB):</div>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>20:49461813
1:169695110
1:169655079
1:27888990
1:196513323
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div class="sos_hint">> /home/gaow/Documents/GTEx/mash_revision/snp_random.txt (549.6 KiB):</div>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>20:49782767
20:49654572
20:49392478
1:169117725
1:170340311
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Compute-LD-for-given-list-of-variants">Compute LD for given list of variants<a class="anchor-link" href="#Compute-LD-for-given-list-of-variants">&#182;</a></h2><p>Code chunk below extracts SNPs from GTEx genotype data and computes <code>r2</code> via PLINK.</p>
<ul>
<li>Steps 1 &amp; 2 extracts data and run PLINK to get a quick estimate for, for example, when a pruning cutoff of 0.2 is set.</li>
<li>Steps 3 &amp; 4 more formally calculates LD on per-chromosome basis</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">sosrun</span> <span class="n">get_ld</span><span class="p">:</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span> <span class="o">-</span><span class="n">b</span> <span class="o">~/</span><span class="n">Documents</span><span class="o">/</span><span class="n">GTEx</span><span class="o">/</span><span class="nb">bin</span>
<span class="p">[</span><span class="n">get_ld_1</span><span class="p">]</span>
<span class="c1"># extract SNPs for given list</span>
<span class="kn">parameter:</span> <span class="n">input_list</span> <span class="o">=</span> <span class="n">snp_list</span>
<span class="kn">depends:</span> <span class="n">genotype_data</span>
<span class="kn">input:</span> <span class="n">input_list</span>
<span class="kn">output:</span> <span class="s2">&quot;${cwd!a}/mash_revision/${input!bn}.extracted.bed&quot;</span>
<span class="kn">task:</span> <span class="kp">workdir</span> <span class="o">=</span> <span class="n">cwd</span>
<span class="kn">run:</span>
    <span class="n">plink</span> <span class="o">--</span><span class="n">bfile</span> <span class="err">$</span><span class="p">{</span><span class="n">genotype_data</span><span class="err">!</span><span class="n">n</span><span class="p">}</span> \
      <span class="o">--</span><span class="n">extract</span> <span class="err">$</span><span class="p">{</span><span class="nb">input</span><span class="p">}</span> \
      <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">sex</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">pheno</span> <span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">parents</span> \
      <span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span> \
      <span class="o">--</span><span class="n">out</span> <span class="err">$</span><span class="p">{</span><span class="n">output</span><span class="err">!</span><span class="n">n</span><span class="p">}</span>

<span class="p">[</span><span class="n">get_ld_2</span><span class="p">]</span>
<span class="c1"># Quickly survey how many SNPs are removed for given cutoff</span>
<span class="n">pairwise_ld_param</span> <span class="o">=</span> <span class="s1">&#39;10000 500 0.2&#39;</span>
<span class="kn">output:</span> <span class="s2">&quot;${input!n}.prune.out&quot;</span>
<span class="kn">run:</span>
    <span class="n">plink</span> <span class="o">--</span><span class="n">bfile</span> <span class="err">$</span><span class="p">{</span><span class="nb">input</span><span class="err">!</span><span class="n">n</span><span class="p">}</span> \
          <span class="o">--</span><span class="n">indep</span><span class="o">-</span><span class="n">pairwise</span> <span class="err">$</span><span class="p">{</span><span class="n">pairwise_ld_param</span><span class="p">}</span> \
          <span class="o">--</span><span class="n">out</span> <span class="err">$</span><span class="p">{</span><span class="n">output</span><span class="err">!</span><span class="n">nn</span><span class="p">}</span>

<span class="p">[</span><span class="n">get_ld_3</span><span class="p">]</span>
<span class="c1"># split data by chrom</span>
<span class="n">chroms</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">22</span><span class="p">)]</span>
<span class="kn">input:</span> <span class="n">for_each</span> <span class="o">=</span> <span class="s1">&#39;chroms&#39;</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s1">&#39;{name}.prune.out&#39;</span>
<span class="kn">output:</span> <span class="n">expand_pattern</span><span class="p">(</span><span class="s1">&#39;{_name}_chr{_chroms}.bed&#39;</span><span class="p">)</span>
<span class="kn">task:</span> <span class="kp">workdir</span> <span class="o">=</span> <span class="n">cwd</span>
<span class="kn">run:</span> 
<span class="n">plink</span> <span class="o">--</span><span class="n">bfile</span> <span class="err">$</span><span class="p">{</span><span class="n">_input</span><span class="err">!</span><span class="n">n</span><span class="p">}</span> \
      <span class="o">--</span><span class="nb">chr</span> <span class="err">$</span><span class="p">{</span><span class="n">_chroms</span><span class="p">}</span> \
      <span class="o">--</span><span class="n">allow</span><span class="o">-</span><span class="n">no</span><span class="o">-</span><span class="n">sex</span> \
      <span class="o">--</span><span class="n">make</span><span class="o">-</span><span class="n">bed</span> \
      <span class="o">--</span><span class="n">out</span> <span class="err">$</span><span class="p">{</span><span class="n">_output</span><span class="err">!</span><span class="n">n</span><span class="p">}</span>

<span class="p">[</span><span class="n">get_ld_4</span><span class="p">]</span>
<span class="c1"># compute LD</span>
<span class="kn">input:</span> <span class="n">group_by</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">pattern</span> <span class="o">=</span> <span class="s1">&#39;{name}.bed&#39;</span>
<span class="kn">output:</span> <span class="n">expand_pattern</span><span class="p">(</span><span class="s1">&#39;{_name}.r2.ld.gz&#39;</span><span class="p">)</span>
<span class="kn">task:</span> <span class="kp">workdir</span> <span class="o">=</span> <span class="n">cwd</span>
<span class="kn">run:</span>
    <span class="n">plink</span> <span class="o">--</span><span class="n">bfile</span> <span class="err">$</span><span class="p">{</span><span class="n">_input</span><span class="err">!</span><span class="n">n</span><span class="p">}</span> \
          <span class="o">--</span><span class="n">out</span> <span class="err">$</span><span class="p">{</span><span class="n">_output</span><span class="err">!</span><span class="n">nn</span><span class="p">}</span> \
          <span class="o">--</span><span class="n">r2</span> <span class="n">square</span> <span class="n">gz</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<div class="sos_hint">1 task completed: <a onclick="task_info('5b8b72200e012d39f40eca525b4bf6ea', 'localhost')">5b8b</a></div>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
plink --bfile /home/gaow/Documents/GTEx/mash_revision/GTEx7.Imputed.extracted \
      --indep-pairwise 10000 500 0.2 \
      --out /home/gaow/Documents/GTEx/mash_revision/GTEx7.Imputed.extracted
PLINK v1.90b4.3 64-bit (9 May 2017)            www.cog-genomics.org/plink/1.9/
(C) 2005-2017 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to /home/gaow/Documents/GTEx/mash_revision/GTEx7.Imputed.extracted.log.
Options in effect:
  --bfile /home/gaow/Documents/GTEx/mash_revision/GTEx7.Imputed.extracted
  --indep-pairwise 10000 500 0.2
  --out /home/gaow/Documents/GTEx/mash_revision/GTEx7.Imputed.extracted

32120 MB RAM detected; reserving 16060 MB for main workspace.
13030 variants loaded from .bim file.
635 people (0 males, 0 females, 635 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
/home/gaow/Documents/GTEx/mash_revision/GTEx7.Imputed.extracted.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 635 founders and 0 nonfounders present.
Calculating allele frequencies... 10111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989 done.
13030 variants and 635 people pass filters and QC.
Note: No phenotypes present.
Pruned 490 variants from chromosome 1, leaving 891.
Pruned 263 variants from chromosome 2, leaving 613.
Pruned 243 variants from chromosome 3, leaving 497.
Pruned 105 variants from chromosome 4, leaving 339.
Pruned 158 variants from chromosome 5, leaving 442.
Pruned 192 variants from chromosome 6, leaving 467.
Pruned 207 variants from chromosome 7, leaving 432.
Pruned 132 variants from chromosome 8, leaving 356.
Pruned 161 variants from chromosome 9, leaving 361.
Pruned 164 variants from chromosome 10, leaving 397.
Pruned 247 variants from chromosome 11, leaving 493.
Pruned 235 variants from chromosome 12, leaving 472.
Pruned 36 variants from chromosome 13, leaving 181.
Pruned 136 variants from chromosome 14, leaving 294.
Pruned 159 variants from chromosome 15, leaving 320.
Pruned 298 variants from chromosome 16, leaving 375.
Pruned 345 variants from chromosome 17, leaving 503.
Pruned 29 variants from chromosome 18, leaving 156.
Pruned 350 variants from chromosome 19, leaving 653.
Pruned 88 variants from chromosome 20, leaving 259.
Pruned 39 variants from chromosome 21, leaving 99.
Pruned 127 variants from chromosome 22, leaving 226.
Pruning complete.  4204 of 13030 variants removed.
Marker lists written to
/home/gaow/Documents/GTEx/mash_revision/GTEx7.Imputed.extracted.prune.in and
/home/gaow/Documents/GTEx/mash_revision/GTEx7.Imputed.extracted.prune.out .

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here I executed steps 1 &amp; 2. You'll see PLINK's log if you expand the code chunk above. But the relevant PLINK output message here is:</p>

<pre><code>Pruning complete.  4204 of 13030 variants removed.</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Examine-LD-strengths-per-chromosome">Examine LD strengths per chromosome<a class="anchor-link" href="#Examine-LD-strengths-per-chromosome">&#182;</a></h2><p>This section takes a deeper look at LD pattern using results from steps 3 &amp; 4. Cell below loads all data and compute some summary statistics on LD strength.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">setwd</span><span class="p">(</span><span class="s1">&#39;~/Documents/GTEx/mash_revision/&#39;</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">)</span>
<span class="n">prop</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">(</span><span class="n">grid</span><span class="p">),</span> <span class="mi">22</span><span class="p">)</span>
<span class="n">snps</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="p">(</span><span class="n">grid</span><span class="p">),</span> <span class="mi">22</span><span class="p">)</span>
<span class="n">n_snps</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="mi">22</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">read</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="s1">&#39;GTEx7.Imputed.extracted_chr&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;.r2.ld.gz&#39;</span><span class="p">))</span>
    <span class="n">tmp</span><span class="p">[</span><span class="ow">is</span><span class="o">.</span><span class="n">na</span><span class="p">(</span><span class="n">tmp</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">rownames</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">=</span> <span class="n">colnames</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="n">diag</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">tmp</span><span class="p">[</span><span class="n">upper</span><span class="o">.</span><span class="n">tri</span><span class="p">(</span><span class="n">tmp</span><span class="p">)]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">n_snps</span> <span class="o">=</span> <span class="n">n_snps</span> <span class="o">+</span> <span class="n">dim</span><span class="p">(</span><span class="n">tmp</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">grid</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">grid</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="n">prop</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="p">((</span><span class="n">dim</span><span class="p">(</span><span class="n">tmp</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">dim</span><span class="p">(</span><span class="n">tmp</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">ss</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">rownames</span><span class="p">(</span><span class="n">m</span><span class="p">)[</span><span class="n">row</span><span class="p">(</span><span class="n">m</span><span class="p">)[</span><span class="n">which</span><span class="p">(</span><span class="n">m</span><span class="p">)]],</span> <span class="n">colnames</span><span class="p">(</span><span class="n">m</span><span class="p">)[</span><span class="n">col</span><span class="p">(</span><span class="n">m</span><span class="p">)[</span><span class="n">which</span><span class="p">(</span><span class="n">m</span><span class="p">)]])</span>
        <span class="n">snps</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">length</span><span class="p">(</span><span class="n">unique</span><span class="p">(</span><span class="n">ss</span><span class="p">))</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is summary of proportion of pairs on each chromosome (row) having LD greater than thresholds (column):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">prop</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="n">prop</span><span class="p">))</span>
<span class="n">colnames</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span> <span class="o">=</span> <span class="n">grid</span>
<span class="n">rownames</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span> <span class="o">=</span> <span class="n">paste</span><span class="p">(</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">22</span><span class="p">)</span>
<span class="n">prop</span>
<span class="nb">apply</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope=col>0.1</th><th scope=col>0.2</th><th scope=col>0.3</th><th scope=col>0.4</th><th scope=col>0.5</th><th scope=col>0.6</th><th scope=col>0.7</th><th scope=col>0.8</th><th scope=col>0.9</th><th scope=col>0.95</th><th scope=col>0.99</th></tr></thead>
<tbody>
	<tr><th scope=row>chr 1</th><td>0.002647735 </td><td>0.001113455 </td><td>0.0007692388</td><td>0.0005520050</td><td>0.0004029846</td><td>0.0003053868</td><td>0.0002277283</td><td>0.0001595147</td><td>0.0001007462</td><td>7.031242e-05</td><td>2.728542e-05</td></tr>
	<tr><th scope=row>chr 2</th><td>0.002238748 </td><td>0.001330724 </td><td>0.0009680365</td><td>0.0007227658</td><td>0.0005505545</td><td>0.0003913894</td><td>0.0002974560</td><td>0.0001983040</td><td>0.0001148076</td><td>6.001305e-05</td><td>1.304631e-05</td></tr>
	<tr><th scope=row>chr 3</th><td>0.003638957 </td><td>0.002022455 </td><td>0.0015067842</td><td>0.0011447171</td><td>0.0008265370</td><td>0.0005522437</td><td>0.0004022967</td><td>0.0003218374</td><td>0.0002413780</td><td>1.353180e-04</td><td>5.485865e-05</td></tr>
	<tr><th scope=row>chr 4</th><td>0.002470868 </td><td>0.001535395 </td><td>0.0011591727</td><td>0.0008744636</td><td>0.0007016045</td><td>0.0005694182</td><td>0.0004067273</td><td>0.0002643727</td><td>0.0001728591</td><td>1.016818e-04</td><td>4.067273e-05</td></tr>
	<tr><th scope=row>chr 5</th><td>0.002170284 </td><td>0.001363383 </td><td>0.0009849750</td><td>0.0008180301</td><td>0.0006455203</td><td>0.0004451864</td><td>0.0003561491</td><td>0.0002448525</td><td>0.0001446856</td><td>8.347245e-05</td><td>1.669449e-05</td></tr>
	<tr><th scope=row>chr 6</th><td>0.003293191 </td><td>0.001729617 </td><td>0.0010977303</td><td>0.0007287453</td><td>0.0005719267</td><td>0.0004520066</td><td>0.0003735973</td><td>0.0002859634</td><td>0.0002029417</td><td>1.245324e-04</td><td>3.689850e-05</td></tr>
	<tr><th scope=row>chr 7</th><td>0.004022743 </td><td>0.002099676 </td><td>0.0015011700</td><td>0.0011332362</td><td>0.0008388891</td><td>0.0006230346</td><td>0.0005003900</td><td>0.0003384991</td><td>0.0002305719</td><td>1.422677e-04</td><td>4.905784e-05</td></tr>
	<tr><th scope=row>chr 8</th><td>0.003694415 </td><td>0.001943986 </td><td>0.0015568721</td><td>0.0013128219</td><td>0.0010603561</td><td>0.0007069041</td><td>0.0005301781</td><td>0.0002945434</td><td>0.0001598950</td><td>1.094018e-04</td><td>1.683105e-05</td></tr>
	<tr><th scope=row>chr 9</th><td>0.003993205 </td><td>0.002316500 </td><td>0.0017575985</td><td>0.0014119620</td><td>0.0010736794</td><td>0.0006986270</td><td>0.0005809635</td><td>0.0004559461</td><td>0.0001838492</td><td>7.353969e-05</td><td>2.206191e-05</td></tr>
	<tr><th scope=row>chr 10</th><td>0.003673287 </td><td>0.002107207 </td><td>0.0016042781</td><td>0.0012732366</td><td>0.0009803922</td><td>0.0007257448</td><td>0.0005665903</td><td>0.0003883372</td><td>0.0002164502</td><td>1.527884e-04</td><td>3.819710e-05</td></tr>
	<tr><th scope=row>chr 11</th><td>0.003291519 </td><td>0.001547014 </td><td>0.0011410599</td><td>0.0009069963</td><td>0.0007789928</td><td>0.0006253886</td><td>0.0004754416</td><td>0.0003510953</td><td>0.0002413780</td><td>1.426325e-04</td><td>5.120140e-05</td></tr>
	<tr><th scope=row>chr 12</th><td>0.004283350 </td><td>0.001979397 </td><td>0.0013863790</td><td>0.0009776777</td><td>0.0007092170</td><td>0.0005409282</td><td>0.0004327426</td><td>0.0003325707</td><td>0.0002444194</td><td>1.482544e-04</td><td>6.411001e-05</td></tr>
	<tr><th scope=row>chr 13</th><td>0.004053593 </td><td>0.002261478 </td><td>0.0015787677</td><td>0.0012374125</td><td>0.0010667349</td><td>0.0006827104</td><td>0.0005973716</td><td>0.0002986858</td><td>0.0001280082</td><td>8.533880e-05</td><td>0.000000e+00</td></tr>
	<tr><th scope=row>chr 14</th><td>0.004651163 </td><td>0.002634575 </td><td>0.0017563832</td><td>0.0012684989</td><td>0.0010082940</td><td>0.0008781916</td><td>0.0007372472</td><td>0.0004553586</td><td>0.0002602049</td><td>1.843118e-04</td><td>4.336749e-05</td></tr>
	<tr><th scope=row>chr 15</th><td>0.004900376 </td><td>0.002716608 </td><td>0.0019217163</td><td>0.0013801417</td><td>0.0009695932</td><td>0.0007774216</td><td>0.0006201902</td><td>0.0004978992</td><td>0.0002183768</td><td>8.735074e-05</td><td>2.620522e-05</td></tr>
	<tr><th scope=row>chr 16</th><td>0.007256952 </td><td>0.003975624 </td><td>0.0029275455</td><td>0.0021536475</td><td>0.0015787519</td><td>0.0012647704</td><td>0.0008313875</td><td>0.0005970070</td><td>0.0003228260</td><td>2.034246e-04</td><td>7.517866e-05</td></tr>
	<tr><th scope=row>chr 17</th><td>0.003475084 </td><td>0.001985365 </td><td>0.0013755541</td><td>0.0011165935</td><td>0.0008743401</td><td>0.0006989152</td><td>0.0005429819</td><td>0.0003619879</td><td>0.0002227618</td><td>1.253035e-04</td><td>3.619879e-05</td></tr>
	<tr><th scope=row>chr 18</th><td>0.003407756 </td><td>0.002173913 </td><td>0.0016451234</td><td>0.0011750881</td><td>0.0009988249</td><td>0.0008225617</td><td>0.0006462985</td><td>0.0004700353</td><td>0.0001175088</td><td>5.875441e-05</td><td>0.000000e+00</td></tr>
	<tr><th scope=row>chr 19</th><td>0.002358195 </td><td>0.001201983 </td><td>0.0008776067</td><td>0.0006487523</td><td>0.0005134298</td><td>0.0003960175</td><td>0.0003024858</td><td>0.0002069639</td><td>0.0001313425</td><td>9.552182e-05</td><td>3.184061e-05</td></tr>
	<tr><th scope=row>chr 20</th><td>0.004797521 </td><td>0.002948477 </td><td>0.0020989156</td><td>0.0013992770</td><td>0.0010661158</td><td>0.0006996385</td><td>0.0004664257</td><td>0.0003165031</td><td>0.0001166064</td><td>6.663224e-05</td><td>0.000000e+00</td></tr>
	<tr><th scope=row>chr 21</th><td>0.009732360 </td><td>0.006135618 </td><td>0.0041256744</td><td>0.0031735957</td><td>0.0023273035</td><td>0.0020099439</td><td>0.0013752248</td><td>0.0013752248</td><td>0.0005289326</td><td>2.115730e-04</td><td>1.057865e-04</td></tr>
	<tr><th scope=row>chr 22</th><td>0.007098249 </td><td>0.004217100 </td><td>0.0030903940</td><td>0.0023338913</td><td>0.0017705382</td><td>0.0015130054</td><td>0.0012232810</td><td>0.0007725985</td><td>0.0004989699</td><td>2.736286e-04</td><td>8.047901e-05</td></tr>
</tbody>
</table>

</div>

</div>

<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<dl class=dl-horizontal>
	<dt>0.1</dt>
		<dd>0.00414316140205588</dd>
	<dt>0.2</dt>
		<dd>0.00233361591922266</dd>
	<dt>0.3</dt>
		<dd>0.00167413526759036</dd>
	<dt>0.4</dt>
		<dd>0.00126107073619321</dd>
	<dt>0.5</dt>
		<dd>0.000968844573194746</dd>
	<dt>0.6</dt>
		<dd>0.000744519756734997</dd>
	<dt>0.7</dt>
		<dd>0.000567870677882685</dd>
	<dt>0.8</dt>
		<dd>0.000408550028183733</dd>
	<dt>0.9</dt>
		<dd>0.000218159995459414</dd>
	<dt>0.95</dt>
		<dd>0.000124366105021849</dd>
	<dt>0.99</dt>
		<dd>3.7725986625247e-05</dd>
</dl>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is summary of number of unique SNPs involved on each chromosome (row) having LD greater than thresholds (column):</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="n">snps</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">frame</span><span class="p">(</span><span class="n">t</span><span class="p">(</span><span class="n">snps</span><span class="p">))</span>
<span class="n">colnames</span><span class="p">(</span><span class="n">snps</span><span class="p">)</span> <span class="o">=</span> <span class="n">grid</span>
<span class="n">rownames</span><span class="p">(</span><span class="n">snps</span><span class="p">)</span> <span class="o">=</span> <span class="n">paste</span><span class="p">(</span><span class="s1">&#39;chr&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">22</span><span class="p">)</span>
<span class="n">snps</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<table>
<thead><tr><th></th><th scope=col>0.1</th><th scope=col>0.2</th><th scope=col>0.3</th><th scope=col>0.4</th><th scope=col>0.5</th><th scope=col>0.6</th><th scope=col>0.7</th><th scope=col>0.8</th><th scope=col>0.9</th><th scope=col>0.95</th><th scope=col>0.99</th></tr></thead>
<tbody>
	<tr><th scope=row>chr 1</th><td>957</td><td>775</td><td>650</td><td>553</td><td>454</td><td>389</td><td>316</td><td>236</td><td>159</td><td>116</td><td>49 </td></tr>
	<tr><th scope=row>chr 2</th><td>531</td><td>408</td><td>350</td><td>278</td><td>236</td><td>194</td><td>166</td><td>123</td><td> 76</td><td> 46</td><td>10 </td></tr>
	<tr><th scope=row>chr 3</th><td>483</td><td>369</td><td>302</td><td>264</td><td>228</td><td>191</td><td>146</td><td>120</td><td> 94</td><td> 60</td><td>29 </td></tr>
	<tr><th scope=row>chr 4</th><td>234</td><td>171</td><td>138</td><td>110</td><td>101</td><td> 88</td><td> 69</td><td> 48</td><td> 34</td><td> 20</td><td> 8 </td></tr>
	<tr><th scope=row>chr 5</th><td>346</td><td>262</td><td>211</td><td>181</td><td>158</td><td>122</td><td>107</td><td> 76</td><td> 46</td><td> 29</td><td> 6 </td></tr>
	<tr><th scope=row>chr 6</th><td>405</td><td>305</td><td>248</td><td>194</td><td>160</td><td>129</td><td>110</td><td> 91</td><td> 68</td><td> 42</td><td>16 </td></tr>
	<tr><th scope=row>chr 7</th><td>397</td><td>321</td><td>273</td><td>233</td><td>190</td><td>149</td><td>121</td><td> 98</td><td> 78</td><td> 50</td><td>19 </td></tr>
	<tr><th scope=row>chr 8</th><td>286</td><td>208</td><td>177</td><td>150</td><td>131</td><td> 94</td><td> 79</td><td> 62</td><td> 38</td><td> 26</td><td> 4 </td></tr>
	<tr><th scope=row>chr 9</th><td>313</td><td>247</td><td>212</td><td>172</td><td>149</td><td>123</td><td>108</td><td> 90</td><td> 42</td><td> 20</td><td> 6 </td></tr>
	<tr><th scope=row>chr 10</th><td>328</td><td>261</td><td>214</td><td>189</td><td>147</td><td>113</td><td> 97</td><td> 76</td><td> 47</td><td> 34</td><td>12 </td></tr>
	<tr><th scope=row>chr 11</th><td>502</td><td>390</td><td>330</td><td>289</td><td>253</td><td>216</td><td>172</td><td>138</td><td>103</td><td> 67</td><td>25 </td></tr>
	<tr><th scope=row>chr 12</th><td>446</td><td>364</td><td>300</td><td>267</td><td>216</td><td>179</td><td>151</td><td>123</td><td> 94</td><td> 66</td><td>29 </td></tr>
	<tr><th scope=row>chr 13</th><td> 90</td><td> 65</td><td> 50</td><td> 42</td><td> 36</td><td> 29</td><td> 25</td><td> 11</td><td>  6</td><td>  4</td><td> 0 </td></tr>
	<tr><th scope=row>chr 14</th><td>277</td><td>220</td><td>172</td><td>134</td><td>121</td><td>106</td><td> 95</td><td> 64</td><td> 38</td><td> 28</td><td> 8 </td></tr>
	<tr><th scope=row>chr 15</th><td>325</td><td>241</td><td>205</td><td>174</td><td>126</td><td>105</td><td> 89</td><td> 76</td><td> 39</td><td> 19</td><td> 6 </td></tr>
	<tr><th scope=row>chr 16</th><td>526</td><td>431</td><td>382</td><td>334</td><td>295</td><td>246</td><td>196</td><td>163</td><td>101</td><td> 68</td><td>25 </td></tr>
	<tr><th scope=row>chr 17</th><td>624</td><td>512</td><td>421</td><td>369</td><td>303</td><td>262</td><td>212</td><td>150</td><td>102</td><td> 66</td><td>23 </td></tr>
	<tr><th scope=row>chr 18</th><td> 69</td><td> 52</td><td> 42</td><td> 28</td><td> 22</td><td> 21</td><td> 16</td><td> 12</td><td>  4</td><td>  2</td><td> 0 </td></tr>
	<tr><th scope=row>chr 19</th><td>694</td><td>555</td><td>456</td><td>386</td><td>346</td><td>280</td><td>224</td><td>164</td><td>111</td><td> 82</td><td>32 </td></tr>
	<tr><th scope=row>chr 20</th><td>189</td><td>142</td><td>110</td><td> 98</td><td> 87</td><td> 62</td><td> 48</td><td> 37</td><td> 14</td><td>  8</td><td> 0 </td></tr>
	<tr><th scope=row>chr 21</th><td> 86</td><td> 69</td><td> 57</td><td> 48</td><td> 38</td><td> 32</td><td> 23</td><td> 23</td><td> 10</td><td>  4</td><td> 2 </td></tr>
	<tr><th scope=row>chr 22</th><td>240</td><td>193</td><td>167</td><td>142</td><td>106</td><td> 92</td><td> 77</td><td> 54</td><td> 40</td><td> 23</td><td> 7 </td></tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Proportion of SNPs involved are:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="nb">apply</span><span class="p">(</span><span class="n">snps</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">sum</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_snps</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<dl class=dl-horizontal>
	<dt>0.1</dt>
		<dd>0.640675364543361</dd>
	<dt>0.2</dt>
		<dd>0.50353031465848</dd>
	<dt>0.3</dt>
		<dd>0.419570222563315</dd>
	<dt>0.4</dt>
		<dd>0.355717574827322</dd>
	<dt>0.5</dt>
		<dd>0.299539524174981</dd>
	<dt>0.6</dt>
		<dd>0.247275518035303</dd>
	<dt>0.7</dt>
		<dd>0.203146584804298</dd>
	<dt>0.8</dt>
		<dd>0.156178050652341</dd>
	<dt>0.9</dt>
		<dd>0.103146584804298</dd>
	<dt>0.95</dt>
		<dd>0.0675364543361474</dd>
	<dt>0.99</dt>
		<dd>0.0242517267843438</dd>
</dl>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-sos"><pre><span></span><span class="o">%</span><span class="n">sessioninfo</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_html rendered_html output_subarea ">
<h2>Session Info</h2>
<p class="session_section">SoS</p>
<table class="session_info">
<tr>
<th>SoS Version</th><td><pre>0.9.8.10</pre></td>
</tr>
<tr>
<th>numpy</th><td><pre>1.13.1</pre></td>
</tr>
</table>
<p class="session_section">R</p>
<table class="session_info">
<tr>
<th>Kernel</th><td><pre>ir</pre></td>
</tr>
<tr>
<th>Language</th><td><pre>R</pre></td>
</tr>
<tr>
<td colspan="2"><pre>R version 3.4.0 (2017-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: BunsenLabs GNU/Linux 8.7 (Hydrogen)

Matrix products: default
BLAS: /usr/lib64/microsoft-r/3.4/lib64/R/lib/libRblas.so
LAPACK: /usr/lib/libopenblasp-r0.2.12.so

locale:
 [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
 [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
 [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
 [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
 [9] LC_ADDRESS=C               LC_TELEPHONE=C            
[11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] RevoUtilsMath_10.0.0

loaded via a namespace (and not attached):
 [1] compiler_3.4.0      R6_2.2.0            magrittr_1.5       
 [4] RevoUtils_10.0.4    IRdisplay_0.4.4     pbdZMQ_0.2-5       
 [7] tools_3.4.0         crayon_1.3.2        uuid_0.1-2         
[10] stringi_1.1.5       IRkernel_0.8.7.9000 jsonlite_1.4       
[13] stringr_1.2.0       digest_0.6.12       repr_0.12.0        
[16] evaluate_0.10      </pre></td>
</tr>
</table>

</div>

</div>

</div>
</div>

</div>
<hr>
Copyright &copy 2016-2020 Gao Wang et al at Stephens Lab, University of Chicago

</div>
</div>
</body>
</html>
